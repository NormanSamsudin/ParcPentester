<!DOCTYPE html>
<html>
<body>
<section id='administration'>
<head><title>Admin Area</title></head>
<?php
require_once('css.php');
function mailform()
{

     $mail = "<form action='' method='GET' autocomplete='off'><table>
     <tr><td>Receiver : <input type='text' name='tomail' value='' placeholder='receiver@mail.com' required>
     Subjects : <input type='text' name='subject' value='' placeholder='Subjects' required></td><tr>
     <tr><td><textarea rows='25' cols='100' name='message' placeholder='Message here'></textarea></td><tr>
     <tr><td><input type='submit' value='Send'></td></tr>
     </table></form>";

    return $mail;

}
function sendMail($toMail,$subject,$message)
{
    if(mail($toMail,$subject,$message))
    {
        return 'Mail successfull!';
    }
    else
    {
        return 'Mail failed';
    }
}

function uploadForm()
{
    $up = "<form action='' method='POST' enctype='multipart/form-data' autocomplete='off'><table>
    <tr><td>Upload Documents : <input type='file' name='files' required></td><tr>
    <tr><td><input type='submit' name='action' value='Upload'></td></tr>
    </table></form>";

   return $up;
}

if($_SERVER['HTTP_HOST']!='127.0.0.1')
{
    header("HTTP/1.1 403 Forbidden");
}
else
{
    echo "<h2>Welcome admin</h2>";
    echo "<div class='adm_body'>";

    echo "<center><a href='?act=email'>Send Email</a><a href='?act=create'>Create File</a></center><br>";
    if(isset($_GET['act']))
    {
        switch($_GET['act'])
        {
            case 'email':
                echo mailform();
                if(isset($_REQUEST['tomail']))
                {
                    echo "<div id='Mresults'>";
                    echo sendMail($_REQUEST['tomail'],$_REQUEST['subject'],$_REQUEST['message']);
                    echo "</div>";
                }
            break;
            case 'upload':
                echo uploadForm();
                if(isset($_POST['action']))
                {
                    $filename = $_FILES['files']['name'];
                    $tempfile = $_FILES['files']['tmp_name'];
                    $path = 'uploads/'.$filename;
                    if(move_uploaded_file($tempfile,$path))
                    {
                        echo "<script>alert('File successfuly uploaded!');</script>";
                    }
                    else
                    {
                        echo "<script>alert('Upload failed!');</script>";
                    }
                }
            break;
            case 'create':
                if(isset($_REQUEST['filename']) && isset($_REQUEST['text']))
                {
                    $f = fopen($_REQUEST['filename'],'w');
                    fwrite($f,$_REQUEST['text']);
                    fclose($f);
                }
            break;
        }
    }

    echo "</div>";
}
?>
</body>
</section>
</html>