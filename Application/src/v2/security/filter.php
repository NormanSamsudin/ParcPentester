<?php

class Security
{
    public function update_filter($sql,$input,$id,$postname)
    {
        $qry = "SELECT $postname FROM members where member_id='$id'";
        $res = $sql->query($qry);
        $row = $res->fetch_assoc();

        if($input=="")
        {
            return $row[$postname];
        }
        else
        {
            return mysqli_real_escape_string($sql,$this->firewall($input));
        }
    }
    public function firewall($input) //  firewall($input,injection_type)
    {
       //For pentest 
       //vuln for boolean based blind
       $filter = array("/UNION/i","/SELECT/i","/ORDER/i","/BY/i","/INFORMATION_SCHEMA/i",
                       "/AND/i","/'/i",'/"/i',"/OR/i");
       foreach($filter as $sqlixss)
       {
        if(preg_match($sqlixss,$input))
        {
            $newvalue = (preg_replace($sqlixss,"",$input));
            return $newvalue;
        }
       }
       return $input;
    }
}

?>