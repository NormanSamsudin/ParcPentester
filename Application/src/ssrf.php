<!DOCTYPE html>
<html>
<head>
<title>SSRF</title>
<style>
.imgx{
    margin-top:50px;
}
img{
    padding:10px;
    border:1px solid #000;
}
</style>
</head>
<body><center>
<h2>Server Side Request Forgery</h2>
<?php
#error_reporting(0);
function saveCache($rand,$ext,$input)
{
    $file = fopen('cache/'.$rand.'.'.$ext,'w+');
    fwrite($file,base64_decode($input));
    fclose($file);
}
if(isset($_POST['submit']) || isset($_REQUEST['url']))
{
    if(isset($_POST['url'])) { $url = $_POST['url']; }
    if(isset($_REQUEST['url'])) { $url = $_REQUEST['url']; }
        $content = file_get_contents($url) or die("<hr></hr></br>Something problem!");

        /*eval("?>".$content);*/
        $info = pathinfo($url);
        $rand = sha1(mt_rand(9999,9999999));

        switch($info['extension'])
        {
            case 'jpg':
            case 'png':
            case 'gif':
                echo "<div class='imgx'><h3>Image</h3></br>";
                echo "<img src='data:image/jpeg;base64,".base64_encode($content)."' width='200px' height='100px'>";
                echo "</div>";
                saveCache($rand,$info['extension'],base64_encode($content));
            break;
            case 'svg':
                echo $content;
                saveCache($rand,$info['extension'],base64_encode($content));
            default:
                $ch = curl_init();
                curl_setopt($ch,CURLOPT_HEADER,0);
                curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
                curl_setopt($ch,CURLOPT_URL,$url);
                $data = curl_exec($ch);
                if(curl_errno($ch))
                {
                    print curl_error($ch);
                }
                else
                {
                    echo $data;
                }
                curl_close($ch);
            break;
        }
}
else
{
    ?>
    <form action='' method='POST' autocomplete='OFF'>
    <input type='text' name='url'>
    <input type='submit' name='submit' value='Read'>
    </form>
    <?php
}

?>
</center>
</body>
</html>